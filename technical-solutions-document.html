<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technical Solutions Document - Sun Life Claims Tracking</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.6;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 40px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            margin-top: 30px;
            border-bottom: 2px solid #ecf0f1;
            padding-bottom: 8px;
        }
        h3 {
            color: #7f8c8d;
            margin-top: 20px;
        }
        .checkmark {
            color: #27ae60;
            font-weight: bold;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .mermaid {
            background-color: #fafafa;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            padding: 20px;
            margin: 20px 0;
        }
        code {
            background-color: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        pre {
            background-color: #f4f4f4;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
        }
        .formula {
            background-color: #e8f4f8;
            padding: 15px;
            border-left: 4px solid #3498db;
            margin: 15px 0;
            font-family: monospace;
        }
        ul {
            line-height: 1.8;
        }
        .phase {
            background-color: #ecf0f1;
            padding: 15px;
            margin: 10px 0;
            border-radius: 4px;
        }
        hr {
            border: none;
            border-top: 2px solid #ecf0f1;
            margin: 30px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß© TECHNICAL SOLUTIONS DOCUMENT</h1>
        <h2>End-to-End Claim Tracking + True TAT + Accurate Counts</h2>
        <h3>Multi-Source Claims Processing: FTP, Email & BOT Workflow Integration</h3>
        <p><strong>Version 1.0</strong></p>

        <hr>

        <h2>1. Executive Summary</h2>
        <p>Sun Life receives claim files from 6 administrators via two methods:</p>
        <ul>
            <li><strong>FTP claim files</strong> from 5 administrators (UMR, Meritain, Aetna, Anthem, Glenavon)</li>
            <li><strong>Email claim files</strong> from 1 administrator (Cigna only)</li>
            <li><strong>Email notifications</strong> from all 6 administrators (notifications only, not actual claims except for Cigna)</li>
        </ul>
        <p><strong>Current issues</strong> (inaccuracy, exceptions lost, wrong counts) arise because:</p>
        <ul>
            <li>Email notifications are being treated as claims and moved to "Completed" folder before BOT processing</li>
            <li>When BOT returns exceptions, those emails are already marked as completed</li>
            <li>This creates phantom "completed" counts that don't match actual claim processing</li>
        </ul>
        <p>This document provides a fully accurate, auditable system for:</p>
        <ul>
            <li>Tracking the true number of claims received</li>
            <li>Tracking completed vs. exception cases</li>
            <li>Mapping BOT and manual processing</li>
            <li>Calculating true turnaround time (TAT)</li>
            <li>Automating Outlook email movement</li>
            <li>Creating 1:1 lifecycle tracking of every claim</li>
        </ul>

        <hr>

        <h2>2. Core Understandings</h2>
        <ul>
            <li>Email notifications are NOT claims (except for Cigna)</li>
            <li>FTP files are the source of claims for 5 administrators</li>
            <li>Cigna is the only administrator that sends claim files via email attachments</li>
            <li>BOT results dictate Completed vs. Exception</li>
            <li>Email movement must happen AFTER the BOT report (critical for accuracy)</li>
            <li>Meritain ZIP files must be expanded and tracked individually</li>
            <li>TAT requires full lifecycle timestamps (T0 ‚Üí T3)</li>
            <li>No standard file naming convention across administrators - unique 10-digit hash will ensure tracking</li>
        </ul>

        <hr>

        <h2>3. Lifecycle Timestamps (Required for True TAT)</h2>
        <table>
            <thead>
                <tr>
                    <th>Timestamp</th>
                    <th>Meaning</th>
                    <th>Source</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>T0</strong></td>
                    <td>Claim file arrived in FTP</td>
                    <td>FTP metadata / assignments </td>
                </tr>
                <tr>
                    <td><strong>T1</strong></td>
                    <td>File moved to BOT Action folder</td>
                    <td>BOT submission script</td>
                </tr>
                <tr>
                    <td><strong>T2</strong></td>
                    <td>BOT result time (Completed/Exception)</td>
                    <td>BOT morning report</td>
                </tr>
                <tr>
                    <td><strong>T3</strong></td>
                    <td>File successfully loaded into CMS</td>
                    <td>Data Intake Validation Report</td>
                </tr>
            </tbody>
        </table>

        <h3>Turnaround Time Formula</h3>
        <div class="formula">
            TAT = BusinessDays(T0 ‚Üí T3)
        </div>

        <hr>

        <h2>4. High-Level System Overview</h2>
        <div class="mermaid">
flowchart TD
    A[Email Notifications<br/>5 Administrators<br/>Indicators Only] --> B[Inbox Tracking<br/>Do NOT treat as claims]
    C[FTP Claim Files<br/>5 Administrators<br/>Source of Truth] --> D[Assignment Job<br/>Extract and Count Files]
    C2[Email Claim Files<br/>Cigna Only<br/>Extract from Email] --> D
    
    D --> E[Assign FileID plus T0<br/>10-Digit Hash]
    E --> F[Move Files to BOT Folder<br/>Assign T1]
    F --> G[BOT Overnight Processing]
    G --> H[BOT Morning Report<br/>Completed Exceptions Pending]
    
    H --> I[Completed Files<br/>Move emails to Completed<br/>Assign T2]
    H --> J[Business Exceptions<br/>Keep emails in Inbox<br/>Assign T2]
    H --> K[Pending<br/>No movement]
    
    B --> I
    
    I --> L[CMS Intake Validation<br/>Assign T3]
    J --> L
    L --> M[Final TAT and Accurate Counts]
        </div>

        <hr>

        <h2>4a. Administrator-Specific Workflows</h2>
        <p>Each administrator has a slightly different workflow for delivering claim files:</p>
        
        <table>
            <thead>
                <tr>
                    <th>Administrator</th>
                    <th>Claim Files Delivery</th>
                    <th>Email Notifications</th>
                    <th>Special Notes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Cigna</strong></td>
                    <td>Email attachments</td>
                    <td>N/A (email IS the claim)</td>
                    <td>Files must be extracted from email, macro unlocks Excel files</td>
                </tr>
                <tr>
                    <td><strong>UMR</strong></td>
                    <td>FTP</td>
                    <td>Yes (auto-moved to completed)</td>
                    <td>Standard FTP workflow</td>
                </tr>
                <tr>
                    <td><strong>Meritain</strong></td>
                    <td>FTP (often large ZIP files with multiple claims)</td>
                    <td>Yes</td>
                    <td>ZIP files must be expanded, can contain thousands of files</td>
                </tr>
                <tr>
                    <td><strong>Aetna</strong></td>
                    <td>FTP</td>
                    <td>Yes (notification when files drop)</td>
                    <td>Standard FTP workflow</td>
                </tr>
                <tr>
                    <td><strong>Anthem</strong></td>
                    <td>FTP</td>
                    <td>Yes (both broker and anthem notifications)</td>
                    <td>Multiple notification types</td>
                </tr>
                <tr>
                    <td><strong>Glenavon</strong></td>
                    <td>FTP</td>
                    <td>Yes</td>
                    <td>Standard FTP workflow</td>
                </tr>
            </tbody>
        </table>

        <p><strong>Key Takeaway:</strong> For 5 administrators, email notifications are just indicators. For Cigna, the email attachment IS the claim file that needs processing.</p>

        <hr>

        <h2>5. FileID Strategy (Required for 1:1 Accuracy)</h2>
        <p>Every claim file receives a stable identifier with a randomized 10-digit hash:</p>
        <pre><code>&lt;OriginalFilename&gt;_&lt;10DigitHash&gt;</code></pre>
        
        <p><strong>Note:</strong> There is no standard file naming convention across administrators. The 10-digit hash serves as the unique identifier to track each file throughout its lifecycle, regardless of the original naming structure.</p>

        <h3>Meritain ZIP Splitting</h3>
        <pre><code>ZIPID = &lt;ZipName&gt;_&lt;10DigitHash&gt;
ChildID = &lt;ZIPID&gt;_&lt;InnerFileName&gt;_&lt;10DigitHash&gt;</code></pre>
        <p>Each extracted file becomes its own claim with its own lifecycle.</p>

        <hr>

        <hr>

        <h2>7. Inbox Management Rules (Critical)</h2>
        
        <h3>The Problem (Current State):</h3>
        <p>Currently, when 100 files are sent to BOT, the 100 corresponding email notifications are immediately moved to the "Completed" folder. However, if BOT returns 50 as exceptions, those 50 emails are already marked as completed. This creates:</p>
        <ul>
            <li>Inflated "completed" counts (100 shown vs. 50 actually completed)</li>
            <li>Mismatch between email counts and actual claims processed</li>
        </ul>

        <h3>The Solution (New Workflow):</h3>
        
        <h4>Night Before (3:30 PM or later):</h4>
        <ul>
            <li>Assignment job runs and counts claims from FTP/Email</li>
            <li>Files are moved to BOT Action folder with T1 timestamp</li>
            <li><strong>Notification emails remain untouched in Inbox</strong></li>
        </ul>

        <h4>Morning (After BOT Report - approximately 6:30 AM):</h4>
        <ul>
            <li><strong>Completed</strong> ‚Üí Move ONLY the number of emails that match completed count to Completed folder</li>
            <li><strong>Exceptions</strong> ‚Üí Leave notification emails in Inbox (these represent real work to be done)</li>
            <li><strong>Pending</strong> ‚Üí No movement until BOT processes them</li>
        </ul>

        <h3>Short-Term Manual Solution:</h3>
        <p>Until automation is implemented:</p>
        <ol>
            <li>Review BOT morning report (e.g., "15 files sent, 7 completed, 8 exceptions")</li>
            <li>Manually move exactly 7 emails to Completed folder (doesn't matter which 7)</li>
            <li>Leave 8 emails in Inbox to represent the 8 exceptions needing manual work</li>
            <li>Run mailbox count AFTER moving emails (not before)</li>
        </ol>

        <h3>Results:</h3>
        <ul>
            <li>Completed folder = true completed work</li>
            <li>Inbox = true exception inventory</li>
            <li>No double-counting</li>
            <li>Email counts finally match real BOT outcomes</li>
        </ul>

        <hr>

        <h2>8. Accurate Counts (Redefined)</h2>
        
        <h3>Count 1 ‚Äî Claims Received (Accurate)</h3>
        <ul>
            <li><strong>Source for 5 administrators:</strong> FTP ‚Üí expanded ZIP contents ‚Üí FileIDs</li>
            <li><strong>Source for Cigna:</strong> Email attachments extracted ‚Üí FileIDs</li>
            <li>Email notifications are irrelevant for counting (except Cigna where email IS the claim)</li>
        </ul>

        <h3>Count 2 ‚Äî Claims Completed (Accurate)</h3>
        <p><strong>Source:</strong></p>
        <ul>
            <li>BOT completed files (from morning report)</li>
            <li>Exceptions are NOT counted as completed</li>
            <li>CMS validation ensures final completion</li>
            <li><strong>Critical:</strong> Do not count based on email folder moves - only BOT report results</li>
        </ul>

        <h3>Count 3 ‚Äî Email Notifications Received</h3>
        <ul>
            <li>Useful for trend analysis, but NOT claim volume</li>
            <li>Exception: For Cigna, email count = claim count</li>
        </ul>

        <hr>

        <h2>9. Unified Datastore Structure</h2>
        <table>
            <thead>
                <tr>
                    <th>FileID</th>
                    <th>Admin</th>
                    <th>OriginalFile</th>
                    <th>ParentZIP</th>
                    <th>T0</th>
                    <th>T1</th>
                    <th>T2</th>
                    <th>T3</th>
                    <th>BOT Result</th>
                    <th>ManualTime</th>
                    <th>TAT</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td colspan="11" style="text-align: center; color: #7f8c8d;"><em>Data rows...</em></td>
                </tr>
            </tbody>
        </table>

        <p>This table powers:</p>
        <ul>
            <li>TAT calculations</li>
            <li>Exception tracking</li>
            <li>Admin-level performance</li>
            <li>Daily volume reporting</li>
            <li>BOT accuracy analysis</li>
        </ul>

        <hr>

        <h2>10. Complete Lifecycle Diagram</h2>
        <div class="mermaid">
flowchart LR
    A[FTP Claim Files] --> B[Assign FileID and T0]
    B --> C[Move to BOT Folder<br/>Assign T1]
    C --> D[BOT Processing Overnight]
    D --> E[BOT Morning Report]
    
    E --> F[Completed<br/>Assign T2]
    F --> G[Move emails to Completed]
    
    E --> H[Exceptions<br/>Assign T2]
    H --> I[Keep emails in Inbox]
    
    F --> J[CMS Load Validation<br/>Assign T3]
    H --> J
    
    J --> K[TAT Calculation<br/>T0 to T3]
        </div>

        <hr>

        <h2>11. Final Output: TAT, Counts, and Accuracy</h2>
        <p>This system provides:</p>
        <ul>
            <li>True TAT based on FTP ‚Üí CMS lifecycle</li>
            <li>Accurate daily claim volume based on FTP file count</li>
            <li>Accurate daily completions based on BOT + CMS</li>
            <li>Clear identification of all exceptions</li>
            <li>Automated Outlook inbox cleanup and integrity</li>
            <li>1:1 tracking for every claim file</li>
        </ul>

        <hr>

        <h2>12. Implementation Roadmap</h2>
        
        <div class="phase">
            <h3>Phase 1 ‚Äî Foundation</h3>
            <ul>
                <li>FileID generator with 10-digit hash</li>
                <li>FTP extraction workflow</li>
                <li>Email extraction workflow (Cigna-specific)</li>
                <li>ZIP expansion (Meritain-specific)</li>
                <li>Datastore creation</li>
            </ul>
        </div>

        <div class="phase">
            <h3>Phase 2 ‚Äî BOT Integration</h3>
            <ul>
                <li>BOT report parser</li>
                <li>T1 / T2 tracking</li>
                <li>Exception flagging</li>
                <li>Automated file movement to BOT folders</li>
            </ul>
        </div>

        <div class="phase">
            <h3>Phase 3 ‚Äî Email Automation</h3>
            <ul>
                <li>Email matching logic (FileID to email)</li>
                <li>Automated email movement based on BOT results</li>
                <li>Mailbox count automation</li>
                <li>Administrator-specific email handling (especially Cigna)</li>
            </ul>
        </div>

        <div class="phase">
            <h3>Phase 4 ‚Äî TAT Engine</h3>
            <ul>
                <li>T0‚ÄìT3 timestamp population</li>
                <li>Business-day calculation logic</li>
                <li>Manual processing time tracking</li>
                <li>Administrator-level TAT breakdowns</li>
            </ul>
        </div>

        <div class="phase">
            <h3>Phase 5 ‚Äî Reporting & Monitoring</h3>
            <ul>
                <li>Daily automated reports (CSV/Excel)</li>
                <li>Real-time dashboard</li>
                <li>BOT efficiency KPIs</li>
                <li>Exception backlog monitoring</li>
                <li>Administrator performance comparison</li>
            </ul>
        </div>
        
        <div class="phase" style="background-color: #fff3cd; border-left: 4px solid #ffc107;">
            <h3>‚ö†Ô∏è Critical Success Factors</h3>
            <ul>
                <li><strong>Timing:</strong> Emails must not be moved until AFTER BOT report is received</li>
                <li><strong>Mailbox Access:</strong> Python scripts need permission to connect to Outlook mailbox</li>
                <li><strong>File Handling:</strong> Cigna files must be extracted from email before assignment</li>
                <li><strong>Accuracy First:</strong> Manual interim solution needed while automation is being built</li>
            </ul>
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            }
        });
    </script>
</body>
</html>
